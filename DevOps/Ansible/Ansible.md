Назад к: [[DevOps]] ^be62dd

### Общая информация:
Ansible — это инструмент автоматизации, который используется для управления конфигурациями, развертывания приложений и выполнения задач администрирования. Он помогает автоматизировать процессы настройки серверов и сервисов, устраняя необходимость в ручных настройках, что значительно упрощает управление ИТ-инфраструктурой. Ansible работает по принципу «безагентной» архитектуры, что значит, что для работы на целевых серверах не требуется установка агента. Вместо этого он использует SSH (или WinRM для Windows) для удаленного выполнения задач. Основные сценарии использования Ansible включают управление конфигурациями серверов, оркестрацию многокомпонентных развертываний, а также выполнение задач автоматизированного администрирования, таких как обновление ПО или управление учетными записями.

### Ключевые моменты:
- Не требует установки клиентов-агентов на целевые машины
- Идемпотентность
- Использует SSH
- Используется YAML для написания конфигурации
- Есть готовые конфигурации 
- Есть UI (Ansible Tower / Ansible AWX)
- Есть свой кэш
- Интеграция с другими DevOps-инструментами(Docker, Kubernetes, Jenkins и тд)

### Основные понятия:
- **Контроллер** — это центральная машина, на которой установлен Ansible и с которой выполняются все команды и сценарии. Контроллер управляет и координирует процессы автоматизации, запускает плейбуки и команды для выполнения задач. Контроллер — это единственное место, где необходимо установить Ansible, так как он передаёт инструкции узлам, не требуя установки агентов на них.
     ^7cdc7f
- **Инвентарь (Inventory)** — это файл или динамически генерируемый список, в котором описаны узлы (серверы и устройства) для управления. Инвентарь связывает контроллер с целевыми узлами, предоставляя информацию об их IP-адресах, именах, группах и дополнительных переменных. Контроллер использует этот список для подключения к нужным узлам и выполнения задач на них.
     ^7dc93a
- **Плейбук (Playbook)** — это YAML-файл, в котором описаны сценарии автоматизации в виде последовательности задач. Плейбук передаёт контроллеру, какие действия нужно выполнить на целевых узлах, как их организовать и с какими параметрами. Плейбуки могут содержать как простые команды, так и сложные сценарии. При запуске плейбука контроллер загружает его задачи и выполняет их в указанной последовательности.
     ^0658ad
- **Модуль (Module)** — это самостоятельный скрипт, который выполняет конкретные задачи, такие как установка ПО, создание файлов, настройка сетей и т.д. При запуске задач из плейбуков контроллер использует модули, отправляя их на узлы для выполнения. После выполнения модуль возвращает результат обратно на контроллер. Модули являются основными строительными блоками для задач и обеспечивают гибкость работы с различными системами.
     ^98b12a
- **Роль (Role)** — это организованная структура, которая содержат плейбуки, шаблоны, переменные и другие компоненты для выполнения связанных задач. Роли помогают структурировать плейбуки и делать их более читаемыми и переиспользуемыми. Контроллер, используя роли, может загружать связанные задачи, файлы и переменные, необходимые для конкретных процессов на узлах.
     ^4bd7b0
- **Плагин (Plugin)** расширяет функциональность Ansible, добавляя специфические возможности для подключения, кеширования данных, обработки логов и других действий. Контроллер может использовать плагины для дополнительных операций, таких как мониторинг процессов или расширение стандартных возможностей Ansible.
     ^5364c8
- **Шаблон (Template)** представляет из себя файл с динамическим содержимым на языке Jinja2, который позволяет создавать настраиваемые конфигурационные файлы. Контроллер использует шаблоны для генерации файлов с подстановкой переменных, которые отправляются на узлы, где применяются в качестве готовых конфигураций.

### Как работает:
- [[Ansible#^7cdc7f|Контроллер]] анализирует [[Ansible#^7dc93a|инвентарь]], чтобы определить целевые узлы, к которым он подключится.
- Загружает [[Ansible#^0658ad|плейбук]], чтобы определить последовательность задач для выполнения.
- Выполняет каждую задачу, используя соответствующие [[Ansible#^98b12a|модули]] и передавая инструкции целевым узлам.
- Если задачи требуют, использует [[Ansible#^4bd7b0|роли]], переменные и шаблоны для гибкости и параметризации.
- При необходимости применяет [[Ansible#^5364c8|плагины]] для дополнительных функций, таких как обработка логов. 
- Узлы выполняют задачи и возвращают результат обратно на [[Ansible#^7cdc7f|контроллер]], который агрегирует данные и отображает результат выполнения для пользователя.

[[Ansible#^be62dd|Наверх]]